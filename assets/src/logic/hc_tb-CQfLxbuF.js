import{r as j,o as D,p as m,j as i,q as C}from"../../vendor-6J9SHA5K.js";import{u as c}from"../lib/timeline_state-Dw4tu5kw.js";import{C as B,a as $,b as A,c as p}from"../components/ui/context-menu-BlNYhH7B.js";import{e as h,f as S}from"../lib/consts-Cj2W_VlV.js";import{d as F}from"../lib/data_store-DFUoucx7.js";function R({glyphItem:t}){const a=c(e=>e.removeItem),o=c(e=>e.updateSelectedItem),s=c(e=>e.toggleSelection),r=c(e=>e.appSettings.timelinePixelFactor),[d,u]=j.useState(!1),k=e=>{o({effectId:e})},[{x:b},v]=D(()=>({x:0})),w=E(e=>{const n=F.get("editorScrollX")??0,l=(e+n)*1e3/r-t.startTimeMilis,g={startTimeMilis:l>0?l/10:l};o(g)},25),M=m(({xy:e})=>{d||w(e[0])},{axis:"x"}),T=m(({down:e,movement:[n],last:x})=>{if(d&&(v.start({x:e?n:0,immediate:!0}),x)){const f={durationMilis:n/r*1e3+20};u(!1),o(f)}},{axis:"x"});return i.jsxs(B,{children:[i.jsx($,{onContextMenu:()=>{s(t)},children:i.jsxs("div",{...M(),title:`Click to select / unselect, right click to delete
Start Time: ${(t.startTimeMilis/1e3).toFixed(2)} s
Duration: ${(t.durationMilis/1e3).toFixed(2)} s
Effect: ${h[t.effectId]??"Unkown / Imported"}
Starting Brightness: ${(t.startingBrightness/S*100).toFixed(2)}%`,onClick:e=>{e.preventDefault(),t.isSelected?s(t,!1):s(t,!0)},className:`h-full border-primary relative flex items-center  cursor-auto border-red-500 rounded-md bg-slate-900 text-black ${t.isSelected?"outline outline-red-500 outline-[3px]":""}`,style:{width:`${t.durationMilis/1e3*r}px`,touchAction:"none"},children:[i.jsx("div",{className:"h-full w-full grid grid-flow-col items-end ",children:t.effectData.map((e,n)=>i.jsx("div",{className:"bg-red-50/90 h-full w-full rounded-t-full",style:{height:`${e/S*100}%`}},n))}),t.isSelected&&i.jsx(C.div,{...T(),onMouseDown:()=>u(!0),className:`text-white bg-red-500 absolute right-[-5px] cursor-col-resize select-none rounded-sm ${d?"h-screen w-[3px] p-0 absolute  bg-red-600 z-10 right-0":" p-1 pb-[8px]"}`,style:{x:b,touchAction:"none"},children:"|"})]})}),i.jsxs(A,{children:[i.jsx(p,{onClick:e=>{e.preventDefault(),a(t.id,t.glyphId)},children:"Delete"}),Object.entries(h).map(e=>i.jsx(p,{onClick:()=>k(+e[0]),children:e[1]},e[0]))]})]})}function E(t,a){let o,s;return function(...r){s?(clearTimeout(o),o=setTimeout(()=>{Date.now()-s>=a&&(t(...r),s=Date.now())},a-(Date.now()-s))):(s=Date.now(),o=setTimeout(()=>{t(...r),s=Date.now()},a))}}export{R as H};
