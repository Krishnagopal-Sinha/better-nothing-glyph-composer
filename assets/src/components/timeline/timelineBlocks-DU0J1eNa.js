import{r as D,o as j,p as f,j as i,q as v}from"../../../vendor-6J9SHA5K.js";import{u as c}from"../../lib/timeline_state-Dw4tu5kw.js";import{C as g,a as B,b as $,c as p}from"../ui/context-menu-BlNYhH7B.js";import{e as S,f as A}from"../../lib/consts-Cj2W_VlV.js";import{d as F}from"../../lib/data_store-DFUoucx7.js";function R({glyphItem:t}){const r=c(e=>e.removeItem),s=c(e=>e.updateSelectedItem),o=c(e=>e.toggleSelection),n=c(e=>e.appSettings.timelinePixelFactor),[d,u]=D.useState(!1),k=e=>{s({effectId:e})},[{x:T},M]=j(()=>({x:0})),b=E(e=>{const a=F.get("editorScrollX")??0,l=(e+a)*1e3/n-t.startTimeMilis,w={startTimeMilis:l>0?l/10:l};s(w)},25),h=f(({xy:e})=>{d||b(e[0])},{axis:"x"}),C=f(({down:e,movement:[a],last:x})=>{if(d&&(M.start({x:e?a:0,immediate:!0}),x)){const m={durationMilis:a/n*1e3+20};u(!1),s(m)}},{axis:"x"});return i.jsxs(g,{children:[i.jsx(B,{onContextMenu:()=>{o(t)},children:i.jsx("div",{...h(),title:`Click to select / unselect, right click to delete
Start Time: ${(t.startTimeMilis/1e3).toFixed(2)} s
Duration: ${(t.durationMilis/1e3).toFixed(2)} s
Effect: ${S[t.effectId]??"Unkown / Imported"}
Starting Brightness: ${(t.startingBrightness/A*100).toFixed(2)}%`,onClick:e=>{e.preventDefault(),t.isSelected?o(t,!1):o(t,!0)},className:`h-full border-primary relative flex items-center cursor-auto border-red-500 rounded-md bg-white text-black ${t.isSelected?"outline outline-red-500 outline-[3px]":""}`,style:{width:`${t.durationMilis/1e3*n}px`,touchAction:"none"},children:t.isSelected&&i.jsx(v.div,{...C(),onMouseDown:()=>u(!0),className:`text-white bg-red-500 absolute right-[-5px] cursor-col-resize select-none rounded-sm ${d?"h-screen w-[3px] p-0 absolute  bg-red-600 z-10 right-0":" p-1 pb-[8px]"}`,style:{x:T,touchAction:"none"},children:"|"})})}),i.jsxs($,{children:[i.jsx(p,{onClick:e=>{e.preventDefault(),r(t.id,t.glyphId)},children:"Delete"}),Object.entries(S).map(e=>i.jsx(p,{onClick:()=>k(+e[0]),children:e[1]},e[0]))]})]})}function E(t,r){let s,o;return function(...n){o?(clearTimeout(s),s=setTimeout(()=>{Date.now()-o>=r&&(t(...n),o=Date.now())},r-(Date.now()-o))):(o=Date.now(),s=setTimeout(()=>{t(...n),o=Date.now()},r))}}export{R as T};
